<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="HYLTianMeng">





<title>OI代码仓库 | HYL&#39;s BLog</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
            <!-- MathJax配置，可通过单美元符号书写行内公式等 -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    "HTML-CSS": {
        preferredFont: "TeX",
        availableFonts: ["STIX","TeX"],
        linebreaks: { automatic:true },
        EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
    },
    tex2jax: {
        inlineMath: [ ["$", "$"], ["\\(","\\)"] ],
        processEscapes: true,
        ignoreClass: "tex2jax_ignore|dno",
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
        equationNumbers: { autoNumber: "AMS" },
        noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } },
        Macros: { href: "{}" }
    },
    messageStyle: "none"
    });
</script>
<!-- 给MathJax元素添加has-jax class -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<!-- 通过连接CDN加载MathJax的js代码 -->
<script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


        
    


<meta name="generator" content="Hexo 7.3.0"></head>

<body>
    <script>
        // this function is used to check current theme before page loaded.
        (() => {
            const currentTheme = window.localStorage && window.localStorage.getItem('theme') || '';
            const isDark = currentTheme === 'dark';
            const pagebody = document.getElementsByTagName('body')[0]
            if (isDark) {
                pagebody.classList.add('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "· Dark"
            } else {
                pagebody.classList.remove('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "· Light"
            }
        })();
    </script>

    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">HYL&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">HYL&#39;s Blog</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
            <div class="main">
                <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    var tocbot_timer;
    var DEPTH_MAX = 6; // 为 6 时展开所有
    var tocbot_default_config = {
        tocSelector: '.tocbot-list',
        contentSelector: '.post-content',
        headingSelector: 'h1, h2, h3, h4, h5',
        orderedList: false,
        scrollSmooth: true,
        onClick: extend_click,
    };

    function extend_click() {
        clearTimeout(tocbot_timer);
        tocbot_timer = setTimeout(function() {
            tocbot.refresh(obj_merge(tocbot_default_config, {
                hasInnerContainers: true
            }));
        }, 420); // 这个值是由 tocbot 源码里定义的 scrollSmoothDuration 得来的
    }

    document.ready(function() {
        tocbot.init(obj_merge(tocbot_default_config, {
            collapseDepth: 1
        }));
    });

    function expand_toc() {
        var b = document.querySelector('.tocbot-toc-expand');
        var expanded = b.getAttribute('data-expanded');
        expanded ? b.removeAttribute('data-expanded') : b.setAttribute('data-expanded', true);
        tocbot.refresh(obj_merge(tocbot_default_config, {
            collapseDepth: expanded ? 1 : DEPTH_MAX
        }));
        b.innerText = expanded ? 'Expand all' : 'Collapse all';
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

    function obj_merge(target, source) {
        for (var item in source) {
            if (source.hasOwnProperty(item)) {
                target[item] = source[item];
            }
        }
        return target;
    }
</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">OI代码仓库</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">HYLTianMeng</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">June 19, 2022&nbsp;&nbsp;14:10:47</a>
                        </span>
                    
                    
                        <span class="post-category">
                    Category:
                            
                                <a href="/categories/%E4%BB%A3%E7%A0%81%E4%BB%93%E5%BA%93/">代码仓库</a>
                            
                        </span>
                    
                </div>
            
        </header>

        <div class="post-content">
            <h1 id="二次剩余"><a href="#二次剩余" class="headerlink" title="二次剩余"></a>二次剩余</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">ll n,p,w;</span><br><span class="line"><span class="type">int</span> t;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">ksm</span><span class="params">(ll a,ll b)</span></span>&#123;</span><br><span class="line">	ll res=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(b)&#123;</span><br><span class="line">		<span class="keyword">if</span>(b&amp;<span class="number">1</span>) res=(res*a)%p;</span><br><span class="line">		a=(a*a)%p;</span><br><span class="line">		b&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> (res%p+p)%p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">lrd</span><span class="params">(ll x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">ksm</span>(x,(p<span class="number">-1</span>)&gt;&gt;<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">rode</span>&#123;</span><br><span class="line">	ll x,y;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">intt</span><span class="params">(ll x_,ll y_)</span></span>&#123;</span><br><span class="line">		x=x_;y=y_;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">inline</span> rode <span class="keyword">operator</span> * (<span class="type">const</span> rode &amp;a,<span class="type">const</span> rode &amp;b)&#123;</span><br><span class="line">	rode c;c.<span class="built_in">intt</span>(((a.x*b.x)%p+a.y*b.y%p*w%p)%p,(a.x*b.y%p+a.y*b.x%p)%p);</span><br><span class="line">	<span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">inline</span> rode <span class="keyword">operator</span> ^ (rode a,ll b)&#123;</span><br><span class="line">	rode c;c.<span class="built_in">intt</span>(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">while</span>(b)&#123;</span><br><span class="line">		<span class="keyword">if</span>(b&amp;<span class="number">1</span>) c=c*a;</span><br><span class="line">		a=a*a;</span><br><span class="line">		b&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">solve</span><span class="params">(ll x)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> if_=<span class="built_in">lrd</span>(x);</span><br><span class="line">	<span class="keyword">if</span>(if_==p<span class="number">-1</span>) <span class="built_in">printf</span>(<span class="string">&quot;Hola!\n&quot;</span>);</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(if_==<span class="number">0</span>) <span class="built_in">printf</span>(<span class="string">&quot;0\n&quot;</span>);</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		ll q=<span class="built_in">rand</span>()%p;w=(((q*q)%p-n)%p+p)%p;</span><br><span class="line">		<span class="keyword">while</span>(<span class="built_in">lrd</span>(w)&lt;=<span class="number">1</span>) q=<span class="built_in">rand</span>()%p,w=(((q*q)%p-n)%p+p)%p;</span><br><span class="line">		rode a;a.<span class="built_in">intt</span>(q,<span class="number">1</span>);</span><br><span class="line">		a=a^((p<span class="number">+1</span>)&gt;&gt;<span class="number">1</span>);</span><br><span class="line">		ll ans1=a.x,ans2=p-ans1;</span><br><span class="line">		<span class="keyword">if</span>(ans1&gt;ans2) ans1^=ans2,ans2^=ans1,ans1^=ans2;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%lld %lld\n&quot;</span>,ans1,ans2);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">srand</span>(<span class="built_in">time</span>(<span class="number">0</span>));</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;t);</span><br><span class="line">	<span class="keyword">while</span>(t--)&#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld&quot;</span>,&amp;n,&amp;p);</span><br><span class="line">		<span class="built_in">solve</span>(n);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="李超树"><a href="#李超树" class="headerlink" title="李超树"></a>李超树</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> f(i,x) (K[(i)]*(x)+B[(i)])</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ls(k) k&lt;&lt;1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rs(k) k&lt;&lt;1|1</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">Change</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> z,<span class="type">int</span> y,<span class="type">int</span> id)</span></span>&#123;</span><br><span class="line">    <span class="comment">// if(id==243) printf(&quot;z=%d y=%d\n&quot;,z,y);</span></span><br><span class="line">    <span class="comment">// printf(&quot;k=%d l=%d r=%d z=%d y=%d id=%d v[k]=%d\n&quot;,k,l,r,z,y,id,v[k]);</span></span><br><span class="line">    <span class="keyword">if</span>(l==r)&#123;<span class="keyword">if</span>(!v[k]||<span class="built_in">f</span>(v[k],l)&lt;<span class="built_in">f</span>(id,l)) v[k]=id;<span class="keyword">return</span>;&#125;</span><br><span class="line">    <span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(z&lt;=l&amp;&amp;r&lt;=y)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!v[k]) v[k]=id;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">f</span>(v[k],mid)&lt;<span class="built_in">f</span>(id,mid)) <span class="built_in">swap</span>(v[k],id);</span><br><span class="line">        (<span class="built_in">f</span>(v[k],l)&lt;<span class="built_in">f</span>(id,l))?<span class="built_in">Change</span>(<span class="built_in">ls</span>(k),l,mid,z,y,id):<span class="built_in">Change</span>(<span class="built_in">rs</span>(k),mid<span class="number">+1</span>,r,z,y,id);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(z&lt;=mid) <span class="built_in">Change</span>(<span class="built_in">ls</span>(k),l,mid,z,y,id);<span class="keyword">if</span>(y&gt;mid) <span class="built_in">Change</span>(<span class="built_in">rs</span>(k),mid<span class="number">+1</span>,r,z,y,id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Ask</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> w)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r) <span class="keyword">return</span> v[k];<span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> nowid;<span class="keyword">if</span>(w&lt;=mid) nowid=<span class="built_in">Ask</span>(<span class="built_in">ls</span>(k),l,mid,w);<span class="keyword">else</span> nowid=<span class="built_in">Ask</span>(<span class="built_in">rs</span>(k),mid<span class="number">+1</span>,r,w);</span><br><span class="line">    <span class="comment">// printf(&quot;k=%d l=%d r=%d w=%d nowid=%d v[k]=%d\n&quot;,k,l,r,w,nowid,v[k]);</span></span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">f</span>(v[k],w)&lt;<span class="built_in">f</span>(nowid,w))?nowid:v[k];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="dinic-费用流"><a href="#dinic-费用流" class="headerlink" title="dinic 费用流"></a>dinic 费用流</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">spfa</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">mset</span>(vis,<span class="number">0</span>);q.<span class="built_in">push</span>(s);vis[s]=<span class="number">1</span>;<span class="built_in">mset</span>(d,INF);d[s]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(q.<span class="built_in">size</span>())&#123;</span><br><span class="line">        <span class="type">int</span> top=q.<span class="built_in">front</span>();q.<span class="built_in">pop</span>();now[top]=head[top];vis[top]=<span class="number">0</span>;</span><br><span class="line">        <span class="built_in">Next</span>(top)&#123;</span><br><span class="line">            <span class="type">int</span> to=li[x].to,w=li[x].w,f=li[x].f;</span><br><span class="line">            <span class="keyword">if</span>(d[to]&lt;=d[top]+w||!f) <span class="keyword">continue</span>;</span><br><span class="line">            d[to]=d[top]+w;<span class="keyword">if</span>(!vis[to]) q.<span class="built_in">push</span>(to),vis[to]=<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(d[t]==INF) <span class="keyword">return</span> <span class="number">0</span>;<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">dinic</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> flow)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(k==t) <span class="keyword">return</span> flow;vis[k]=<span class="number">1</span>;<span class="type">int</span> rest=flow,x;</span><br><span class="line">    <span class="keyword">for</span>(x=now[k];x;x=li[x].next)&#123;</span><br><span class="line">        <span class="type">int</span> to=li[x].to,w=li[x].w,f=li[x].f;</span><br><span class="line">        <span class="keyword">if</span>((vis[to]&amp;&amp;to!=t)||d[to]!=d[k]+w||!f) <span class="keyword">continue</span>;<span class="type">int</span> now=<span class="built_in">dinic</span>(to,<span class="built_in">min</span>(rest,f));<span class="keyword">if</span>(!now) d[to]=INF;</span><br><span class="line">        rest-=now;li[x].f-=now;li[x^<span class="number">1</span>].f+=now;Ans+=w*now;</span><br><span class="line">        <span class="keyword">if</span>(!rest) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    now[k]=x;<span class="keyword">return</span> flow-rest;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>注意 dinic 函数中第三个判断条件不能省。</li>
<li>$\text{d[t]}$ 的判断一定要放在最后。</li>
</ul>
<p>原因：对于第一个，可能会有负环，就会陷入死循环。对于第二个，如果不放在最后，可能会导致最短路不优，而导致答案变大。</p>
<h1 id="LCT"><a href="#LCT" class="headerlink" title="LCT"></a>LCT</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> ls(k) ch[k][0]</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rs(k) ch[k][1]</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LCT</span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Get</span><span class="params">(<span class="type">int</span> k)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">rs</span>(fa[k])==k;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">PushUp</span><span class="params">(<span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">        val[k]=a[k]^val[<span class="built_in">ls</span>(k)]^val[<span class="built_in">rs</span>(k)];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">C</span><span class="params">(<span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">        <span class="built_in">swap</span>(<span class="built_in">ls</span>(k),<span class="built_in">rs</span>(k));tag[k]^=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">PushDown</span><span class="params">(<span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(tag[k])&#123;</span><br><span class="line">            <span class="built_in">C</span>(<span class="built_in">ls</span>(k));<span class="built_in">C</span>(<span class="built_in">rs</span>(k));tag[k]^=<span class="number">1</span>;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">Root</span><span class="params">(<span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">        <span class="type">int</span> fat=fa[k];</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">ls</span>(fat)!=k&amp;&amp;<span class="built_in">rs</span>(fat)!=k;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">rotate</span><span class="params">(<span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">        <span class="type">int</span> y=fa[k];<span class="type">int</span> z=fa[y],x=<span class="built_in">Get</span>(k);</span><br><span class="line">        <span class="keyword">if</span>(!<span class="built_in">Root</span>(y)) ch[z][<span class="built_in">Get</span>(y)]=k;</span><br><span class="line">        ch[y][x]=ch[k][x^<span class="number">1</span>];fa[ch[k][x^<span class="number">1</span>]]=y;</span><br><span class="line">        ch[k][x^<span class="number">1</span>]=y;fa[y]=k;fa[k]=z;</span><br><span class="line">        <span class="built_in">PushUp</span>(y);<span class="built_in">PushUp</span>(k);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">Update</span><span class="params">(<span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="built_in">Root</span>(k)) <span class="built_in">Update</span>(fa[k]);</span><br><span class="line">        <span class="built_in">PushDown</span>(k);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">Splay</span><span class="params">(<span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">        <span class="built_in">Update</span>(k);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> f=fa[k];!<span class="built_in">Root</span>(k);<span class="built_in">rotate</span>(k),f=fa[k])&#123;</span><br><span class="line">            <span class="keyword">if</span>(!<span class="built_in">Root</span>(f)) <span class="built_in">rotate</span>(<span class="built_in">Get</span>(k)==<span class="built_in">Get</span>(f)?f:k);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Access</span><span class="params">(<span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">        <span class="type">int</span> p;</span><br><span class="line">        <span class="keyword">for</span>(p=<span class="number">0</span>;k;p=k,k=fa[k])&#123;</span><br><span class="line">            <span class="built_in">Splay</span>(k);<span class="built_in">rs</span>(k)=p;<span class="built_in">PushUp</span>(k);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">MakeRoot</span><span class="params">(<span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">        k=<span class="built_in">Access</span>(k);<span class="built_in">C</span>(k);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">Split</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">        <span class="built_in">MakeRoot</span>(x);<span class="built_in">Access</span>(y);<span class="built_in">Splay</span>(y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Find</span><span class="params">(<span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">        <span class="built_in">Access</span>(k);<span class="built_in">Splay</span>(k);<span class="built_in">PushDown</span>(k);</span><br><span class="line">        <span class="keyword">while</span>(<span class="built_in">ls</span>(k)) k=<span class="built_in">ls</span>(k),<span class="built_in">PushDown</span>(k);</span><br><span class="line">        <span class="built_in">Splay</span>(k);<span class="keyword">return</span> k;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">Cut</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">        <span class="built_in">MakeRoot</span>(a);</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">Find</span>(b)==a&amp;&amp;<span class="built_in">rs</span>(a)==b&amp;&amp;<span class="built_in">ls</span>(b)==<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="built_in">rs</span>(a)=fa[b]=<span class="number">0</span>;<span class="built_in">PushUp</span>(a);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">Link</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">        <span class="built_in">MakeRoot</span>(a);<span class="keyword">if</span>(<span class="built_in">Find</span>(b)==a) <span class="keyword">return</span>;<span class="built_in">Splay</span>(a);fa[a]=b;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">Change</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">        <span class="built_in">MakeRoot</span>(k);a[k]=x;<span class="built_in">PushUp</span>(k);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Ask</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">        <span class="built_in">Split</span>(a,b);<span class="keyword">return</span> val[b];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;lct;</span><br></pre></td></tr></table></figure>

<h1 id="后缀自动机"><a href="#后缀自动机" class="headerlink" title="后缀自动机"></a>后缀自动机</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span>&#123;</span><br><span class="line">    <span class="type">int</span> len,link,ch[<span class="number">26</span>];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SAM</span>&#123;</span><br><span class="line">    node p[N];</span><br><span class="line">    <span class="type">int</span> size,last;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="title">SAM</span><span class="params">()</span></span>&#123;</span><br><span class="line">        p[<span class="number">0</span>].len=<span class="number">0</span>;p[<span class="number">0</span>].link=<span class="number">-1</span>;last=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> c)</span></span>&#123;</span><br><span class="line">        <span class="type">int</span> cur=++size;f[size]++;</span><br><span class="line">        p[cur].len=p[last].len<span class="number">+1</span>;</span><br><span class="line">        <span class="type">int</span> now=last;</span><br><span class="line">        <span class="keyword">while</span>(now!=<span class="number">-1</span>&amp;&amp;!p[now].ch[c])&#123;</span><br><span class="line">            p[now].ch[c]=cur;</span><br><span class="line">            now=p[now].link;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(now==<span class="number">-1</span>) p[cur].link=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="type">int</span> q=p[now].ch[c];</span><br><span class="line">            <span class="keyword">if</span>(p[now].len<span class="number">+1</span>==p[q].len) p[cur].link=q;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="type">int</span> clone=++size;</span><br><span class="line">                p[clone]=p[q];p[clone].len=p[now].len<span class="number">+1</span>;</span><br><span class="line">                <span class="keyword">while</span>(now!=<span class="number">-1</span>&amp;&amp;p[now].ch[c]==q)&#123;</span><br><span class="line">                    p[now].ch[c]=clone;now=p[now].link;</span><br><span class="line">                &#125;</span><br><span class="line">                p[q].link=p[cur].link=clone;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        last=cur;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">SAM sam;</span><br></pre></td></tr></table></figure>

<h1 id="实现-Prufer-序列和无根树的双射-O-n-算法"><a href="#实现-Prufer-序列和无根树的双射-O-n-算法" class="headerlink" title="实现 Prufer 序列和无根树的双射 O(n) 算法"></a>实现 Prufer 序列和无根树的双射 O(n) 算法</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> n,m,d[N];</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Subtask1&#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> k=INF,fa[N],p[N];</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">Solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n<span class="number">-1</span>;i++)&#123;</span><br><span class="line">            <span class="type">int</span> x;<span class="built_in">read</span>(x);</span><br><span class="line">            d[x]++;d[i]++;fa[i]=x;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>,j=<span class="number">1</span>;i&lt;=n<span class="number">-2</span>;i++,j++)&#123;</span><br><span class="line">            <span class="keyword">while</span>(d[j]!=<span class="number">1</span>) j++;p[i]=fa[j];d[j]--;d[fa[j]]--;</span><br><span class="line">            <span class="keyword">while</span>(i&lt;=n<span class="number">-2</span>&amp;&amp;d[p[i]]==<span class="number">1</span>&amp;&amp;p[i]&lt;j)&#123;p[i<span class="number">+1</span>]=fa[p[i]];d[p[i]]--;d[fa[p[i]]]--;i++;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> ans=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n<span class="number">-2</span>;i++) ans=(ans^(i*p[i]));</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,ans);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Subtask2&#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> fa[N],p[N],d[N];</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">Solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n<span class="number">-2</span>;i++) <span class="built_in">read</span>(p[i]),d[p[i]]++;</span><br><span class="line">        p[n<span class="number">-1</span>]=n;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++) d[i]++;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>,j=<span class="number">1</span>;i&lt;=n<span class="number">-1</span>;i++,j++)&#123;</span><br><span class="line">            <span class="keyword">while</span>(d[j]!=<span class="number">1</span>) j++;fa[j]=p[i];d[j]--;d[p[i]]--;</span><br><span class="line">            <span class="keyword">while</span>(i&lt;=n<span class="number">-1</span>&amp;&amp;d[p[i]]==<span class="number">1</span>&amp;&amp;p[i]&lt;j)&#123;fa[p[i]]=p[i<span class="number">+1</span>];d[p[i]]--;d[fa[p[i]]]--;i++;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> ans=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n<span class="number">-1</span>;i++) ans=(ans^(i*fa[i]));</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,ans);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="拉格朗日插值"><a href="#拉格朗日插值" class="headerlink" title="拉格朗日插值"></a>拉格朗日插值</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">ksm</span><span class="params">(ll a,ll b,ll mod)</span></span>&#123;</span><br><span class="line">    ll res=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(b)&#123;</span><br><span class="line">        <span class="keyword">if</span>(b&amp;<span class="number">1</span>) (res*=a)%=mod;</span><br><span class="line">        a=a*a%mod;</span><br><span class="line">        b&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">inv</span><span class="params">(ll a)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">ksm</span>(a,mod<span class="number">-2</span>,mod);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ll n,k,x[N],y[N],ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n);<span class="built_in">read</span>(k);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        <span class="built_in">read</span>(x[i]);<span class="built_in">read</span>(y[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        ll fenzi=<span class="number">1</span>,fenmu=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(j==i) <span class="keyword">continue</span>;</span><br><span class="line">            fenmu*=(x[i]-x[j]);fenmu%=mod;</span><br><span class="line">            fenzi*=(k-x[j]);fenzi%=mod;</span><br><span class="line">        &#125;</span><br><span class="line">        ans+=y[i]*fenzi%mod*<span class="built_in">inv</span>(fenmu)%mod;ans%=mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,(ans%mod+mod)%mod);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>需要把分母乘出来再求逆元，这样复杂度的瓶颈就不会是求逆元。</li>
</ul>
<h1 id="FWT-或卷积、和卷积、异或卷积"><a href="#FWT-或卷积、和卷积、异或卷积" class="headerlink" title="FWT 或卷积、和卷积、异或卷积"></a>FWT 或卷积、和卷积、异或卷积</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">FWT1</span><span class="params">(<span class="type">int</span> *f,<span class="type">int</span> n,<span class="type">int</span> op)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> mid=<span class="number">1</span>;mid&lt;=(n&gt;&gt;<span class="number">1</span>);mid&lt;&lt;=<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> l=<span class="number">0</span>;l&lt;n;l+=(mid&lt;&lt;<span class="number">1</span>))</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=l+mid<span class="number">-1</span>;i++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(op==<span class="number">0</span>)&#123;(f[i+mid]+=f[i])%=mod;&#125;</span><br><span class="line">                <span class="keyword">else</span>&#123;(f[i+mid]-=f[i])%=mod;&#125;</span><br><span class="line">            &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">FWT2</span><span class="params">(<span class="type">int</span> *f,<span class="type">int</span> n,<span class="type">int</span> op)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> mid=<span class="number">1</span>;mid&lt;=(n&gt;&gt;<span class="number">1</span>);mid&lt;&lt;=<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> l=<span class="number">0</span>;l&lt;n;l+=(mid&lt;&lt;<span class="number">1</span>))</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=l+mid<span class="number">-1</span>;i++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(op==<span class="number">0</span>)&#123;(f[i]+=f[i+mid])%=mod;&#125;</span><br><span class="line">                <span class="keyword">else</span> (f[i]-=f[i+mid])%=mod;</span><br><span class="line">            &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">FWT3</span><span class="params">(<span class="type">int</span> *f,<span class="type">int</span> n,<span class="type">int</span> op)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> mid=<span class="number">1</span>;mid&lt;=(n&gt;&gt;<span class="number">1</span>);mid&lt;&lt;=<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> l=<span class="number">0</span>;l&lt;n;l+=(mid&lt;&lt;<span class="number">1</span>))</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=l+mid<span class="number">-1</span>;i++)&#123;</span><br><span class="line">                <span class="type">int</span> a=f[i],b=f[i+mid];</span><br><span class="line">                <span class="keyword">if</span>(op==<span class="number">0</span>)&#123;f[i]=(a+b)%mod;f[i+mid]=(a-b)%mod;&#125;</span><br><span class="line">                <span class="keyword">else</span>&#123;f[i]=<span class="number">1ll</span>*((a+b)%mod)%mod*inv2%mod;f[i+mid]=<span class="number">1ll</span>*((a-b)%mod)*inv2%mod;&#125;</span><br><span class="line">            &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="dsu-on-tree"><a href="#dsu-on-tree" class="headerlink" title="dsu on tree"></a>dsu on tree</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> k,<span class="type">bool</span> op)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> x=head[k];x;x=li[x].next)&#123;</span><br><span class="line">        <span class="type">int</span> to=li[x].to;</span><br><span class="line">        <span class="keyword">if</span>(to==fa[k]||to==son[k]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs2</span>(to,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(son[k])&#123;<span class="built_in">dfs2</span>(son[k],<span class="number">1</span>);vis[son[k]]=<span class="number">1</span>;&#125;</span><br><span class="line">    <span class="built_in">Add</span>(k);vis[son[k]]=<span class="number">0</span>;</span><br><span class="line">    ans[k]=sum;</span><br><span class="line">    <span class="keyword">if</span>(!op)&#123;<span class="built_in">Del</span>(k);sum=<span class="number">0</span>;maxx=<span class="number">0</span>;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="set-维护凸包"><a href="#set-维护凸包" class="headerlink" title="set 维护凸包"></a>set 维护凸包</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">Insert</span><span class="params">(<span class="type">int</span> id)</span></span>&#123;</span><br><span class="line">    P now=p[id];</span><br><span class="line">    <span class="keyword">auto</span> it=S.<span class="built_in">upper_bound</span>(now);</span><br><span class="line">    <span class="keyword">auto</span> Right=it;<span class="keyword">auto</span> Left=(--it);</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">Cross</span>(<span class="built_in">Subt</span>((*Right),now),<span class="built_in">Subt</span>((*Left),now))&gt;=<span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">    nowans-=<span class="built_in">GetDis</span>((*Left),(*Right));</span><br><span class="line">    <span class="keyword">while</span>(it!=S.<span class="built_in">begin</span>())&#123;</span><br><span class="line">        <span class="keyword">auto</span> a=it;it--;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">Cross</span>(<span class="built_in">Subt</span>(now,(*a)),<span class="built_in">Subt</span>((*it),(*a)))&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">            nowans=nowans-<span class="built_in">GetDis</span>((*a),(*it));</span><br><span class="line">            S.<span class="built_in">erase</span>(a);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    it=S.<span class="built_in">upper_bound</span>(now);</span><br><span class="line">    <span class="keyword">while</span>((it)!=--S.<span class="built_in">end</span>())&#123;</span><br><span class="line">        <span class="keyword">auto</span> a=it;it++;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">Cross</span>(<span class="built_in">Subt</span>((*it),(*a)),<span class="built_in">Subt</span>(now,(*a)))&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">            nowans=nowans-<span class="built_in">GetDis</span>((*a),(*it));</span><br><span class="line">            S.<span class="built_in">erase</span>(a);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    it=S.<span class="built_in">upper_bound</span>(now);</span><br><span class="line">    <span class="keyword">auto</span> a=it,b=(--it);</span><br><span class="line">    nowans+=<span class="built_in">GetDis</span>((*b),now)+<span class="built_in">GetDis</span>(now,(*a));</span><br><span class="line">    S.<span class="built_in">insert</span>(now);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="求树上-k-级祖先"><a href="#求树上-k-级祖先" class="headerlink" title="求树上 k 级祖先"></a>求树上 k 级祖先</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">edge</span>&#123;</span><br><span class="line">    <span class="type">int</span> to,next;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">Init</span><span class="params">(<span class="type">int</span> to_,<span class="type">int</span> ne_)</span></span>&#123;</span><br><span class="line">        to=to_;next=ne_;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;li[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> head[N],tail;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">Add</span><span class="params">(<span class="type">int</span> from,<span class="type">int</span> to)</span></span>&#123;</span><br><span class="line">    li[++tail].<span class="built_in">Init</span>(to,head[from]);</span><br><span class="line">    head[from]=tail;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> fa[N][<span class="number">21</span>],Son[N],Dep[N],Deep[N],Top[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; u[N],d[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> fat)</span></span>&#123;</span><br><span class="line">    fa[k][<span class="number">0</span>]=fat;<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">20</span>;i++) fa[k][i]=fa[fa[k][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line">    Dep[k]=Dep[fat]<span class="number">+1</span>;Deep[k]=Dep[k];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> x=head[k];x;x=li[x].next)&#123;</span><br><span class="line">        <span class="type">int</span> to=li[x].to;</span><br><span class="line">        <span class="keyword">if</span>(to==fat) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs</span>(to,k);Deep[k]=<span class="built_in">max</span>(Deep[k],Deep[to]);</span><br><span class="line">        <span class="keyword">if</span>(Deep[Son[k]]&lt;Deep[to]) Son[k]=to;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> t)</span></span>&#123;</span><br><span class="line">    Top[k]=t;</span><br><span class="line">    <span class="keyword">if</span>(k==t)&#123;</span><br><span class="line">        <span class="type">int</span> len=Deep[k]-Dep[t];</span><br><span class="line">        d[k].<span class="built_in">push_back</span>(k);<span class="type">int</span> now=k;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=len;i++)&#123;</span><br><span class="line">            now=Son[now];<span class="keyword">if</span>(now==<span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">            d[k].<span class="built_in">push_back</span>(now);</span><br><span class="line">        &#125;</span><br><span class="line">        u[k].<span class="built_in">push_back</span>(k);now=k;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=len;i++)&#123;</span><br><span class="line">            now=fa[now][<span class="number">0</span>];<span class="keyword">if</span>(now==<span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">            u[k].<span class="built_in">push_back</span>(now);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(Son[k]) <span class="built_in">dfs2</span>(Son[k],t);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> x=head[k];x;x=li[x].next)&#123;</span><br><span class="line">        <span class="type">int</span> to=li[x].to;</span><br><span class="line">        <span class="keyword">if</span>(to==fa[k][<span class="number">0</span>]||to==Son[k]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs2</span>(to,to);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">uint s;</span><br><span class="line">ll Ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> uint <span class="title">get</span><span class="params">(uint x)</span> </span>&#123;</span><br><span class="line">	x ^= x &lt;&lt; <span class="number">13</span>;</span><br><span class="line">	x ^= x &gt;&gt; <span class="number">17</span>;</span><br><span class="line">	x ^= x &lt;&lt; <span class="number">5</span>;</span><br><span class="line">	<span class="keyword">return</span> s = x; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n,q,root,ans,lg2[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">Ask</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> x=((<span class="built_in">get</span>(s)^ans)%n)<span class="number">+1</span>;</span><br><span class="line">    <span class="type">int</span> k=(<span class="built_in">get</span>(s)^ans)%Dep[x];</span><br><span class="line">    <span class="comment">// printf(&quot;x=%d k=%d\n&quot;,x,k);</span></span><br><span class="line">    <span class="keyword">if</span>(k==<span class="number">0</span>)&#123;ans=x;<span class="keyword">return</span>;&#125;</span><br><span class="line">    <span class="type">int</span> nowx=fa[x][lg2[k]];<span class="type">int</span> nowk=k-(<span class="number">1</span>&lt;&lt;lg2[k]);</span><br><span class="line">    <span class="comment">// printf(&quot;nowx=%d nowk=%d\n&quot;,nowx,nowk);</span></span><br><span class="line">    <span class="type">int</span> t=Top[nowx],dep=Dep[nowx]-nowk;</span><br><span class="line">    <span class="comment">// printf(&quot;t=%d dep=%d\n&quot;,t,dep);</span></span><br><span class="line">    <span class="comment">// printf(&quot;Dep[t]=%d\n&quot;,Dep[t]);</span></span><br><span class="line">    <span class="keyword">if</span>(dep&gt;Dep[t]) ans=d[t][dep-Dep[t]];</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(dep&lt;=Dep[t]) ans=u[t][Dep[t]-dep];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="KMP-从-0-开始"><a href="#KMP-从-0-开始" class="headerlink" title="KMP 从 0 开始"></a>KMP 从 0 开始</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">nxt[<span class="number">0</span>]=<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>,j=<span class="number">-1</span>;i&lt;len2;i++)&#123;</span><br><span class="line">    <span class="keyword">while</span>(j&gt;<span class="number">-1</span>&amp;&amp;s2[i]!=s2[j<span class="number">+1</span>]) j=nxt[j];</span><br><span class="line">    <span class="keyword">if</span>(s2[i]==s2[j<span class="number">+1</span>]) j++;</span><br><span class="line">    nxt[i]=j;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>,j=<span class="number">-1</span>;i&lt;len1;i++)&#123;</span><br><span class="line">    <span class="keyword">while</span>(j&gt;<span class="number">-1</span>&amp;&amp;(j==len1||s1[i]!=s2[j<span class="number">+1</span>])) j=nxt[j];</span><br><span class="line">    <span class="keyword">if</span>(s1[i]==s2[j<span class="number">+1</span>]) j++;f[i]=j;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="KMP-从-1-开始"><a href="#KMP-从-1-开始" class="headerlink" title="KMP 从 1 开始"></a>KMP 从 1 开始</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>,j=<span class="number">0</span>;i&lt;=len2;i++)&#123;</span><br><span class="line">    <span class="keyword">while</span>(j&gt;<span class="number">0</span>&amp;&amp;s2[i]!=s2[j<span class="number">+1</span>]) j=nxt[j];</span><br><span class="line">    <span class="keyword">if</span>(s2[i]==s2[j<span class="number">+1</span>]) j++;</span><br><span class="line">    nxt[i]=j;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>,j=<span class="number">0</span>;i&lt;=len1;i++)&#123;</span><br><span class="line">    <span class="keyword">while</span>(j&gt;<span class="number">0</span>&amp;&amp;(j==len1||s1[i]!=s2[j<span class="number">+1</span>])) j=nxt[j];</span><br><span class="line">    <span class="keyword">if</span>(s1[i]==s2[j<span class="number">+1</span>]) j++;</span><br><span class="line">    f[i]=j;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="EXKMP"><a href="#EXKMP" class="headerlink" title="EXKMP"></a>EXKMP</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> next[N],extend[N],lens,lent,ans;</span><br><span class="line"><span class="type">char</span> s[N],t[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">getnext</span><span class="params">()</span></span>&#123;</span><br><span class="line">    next[<span class="number">0</span>]=lent;<span class="type">int</span> now=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(t[now]==t[<span class="number">1</span>+now]&amp;&amp;now<span class="number">+1</span>&lt;lent) now++;</span><br><span class="line">    next[<span class="number">1</span>]=now;</span><br><span class="line">    <span class="type">int</span> p0=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;lent;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(i+next[i-p0]&lt;next[p0]+p0) next[i]=next[i-p0];</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="type">int</span> now=next[p0]+p0-i;</span><br><span class="line">            now=<span class="built_in">Max</span>(now,<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">while</span>(t[now]==t[i+now]&amp;&amp;i+now&lt;lent) now++;</span><br><span class="line">            next[i]=now;</span><br><span class="line">            p0=i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">exkmp</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">getnext</span>();</span><br><span class="line">    <span class="type">int</span> now=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(s[now]==t[now]&amp;&amp;now&lt;<span class="built_in">Min</span>(lens,lent)) now++;</span><br><span class="line">    extend[<span class="number">0</span>]=now;</span><br><span class="line">    <span class="type">int</span> p0=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;lens;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(i+next[i-p0]&lt;extend[p0]+p0) extend[i]=next[i-p0];</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="type">int</span> now=extend[p0]+p0-i;</span><br><span class="line">            now=<span class="built_in">Max</span>(now,<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">while</span>(t[now]==s[i+now]&amp;&amp;now&lt;lent&amp;&amp;now+i&lt;lens) now++;</span><br><span class="line">            extend[i]=now;</span><br><span class="line">            p0=i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>在代码中是从 $0$ 开始的，所以 $i$ 相当于 $k+1$ ，$next_{i-p_0}$ 相当于 $l$ ，$extend_{p_0}+p_0$ 相当于 $p$ ，$extend_{p_0}+p_0-i$ 为上图 $s$ 字符串中 $k+1$ 到 $p$ 的距离。</p>
</blockquote>
<h1 id="manacher"><a href="#manacher" class="headerlink" title="manacher"></a>manacher</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">Manacher</span><span class="params">()</span></span>&#123;</span><br><span class="line">    mid=<span class="number">0</span>;maxright=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">rep</span>(i,<span class="number">1</span>,n)&#123;</span><br><span class="line">        <span class="keyword">if</span>(i&lt;maxright) Len[i]=<span class="built_in">min</span>(Len[(mid&lt;&lt;<span class="number">1</span>)-i],maxright-i);<span class="keyword">else</span> Len[i]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(i+Len[i]&lt;=n&amp;&amp;i-Len[i]&amp;&amp;b[i+Len[i]]==b[i-Len[i]]) Len[i]++;</span><br><span class="line">        <span class="keyword">if</span>(i+Len[i]&gt;maxright) maxright=i+Len[i],mid=i;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//#a#a#a#</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意这里 <code>len[(mid&lt;&lt;1)-i]</code> 为 $j$ ，这里 <code>len[mid]+mid-i</code> 为 $i$ 到最右边的距离。<br>在实际实现中，我们让 $maxright$ 作为最右边字符在往右的字符，这样比较好写一点。</p>
</blockquote>
<h1 id="后缀数组"><a href="#后缀数组" class="headerlink" title="后缀数组"></a>后缀数组</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">Sort</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++) cnt[Rank[i]=s[i]]++;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++) cnt[i]+=cnt[i<span class="number">-1</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=n;i&gt;=<span class="number">1</span>;i--) sa[cnt[Rank[i]]--]=i;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> w=<span class="number">1</span>;;w&lt;&lt;=<span class="number">1</span>,m=p)&#123;</span><br><span class="line">        p=<span class="number">0</span>;<span class="keyword">for</span>(<span class="type">int</span> i=n;i&gt;n-w;i--) id[++p]=i;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++) <span class="keyword">if</span>(sa[i]&gt;w) id[++p]=sa[i]-w;</span><br><span class="line">        <span class="built_in">memset</span>(cnt,<span class="number">0</span>,<span class="built_in">sizeof</span>(cnt));</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++) cnt[px[i]=Rank[id[i]]]++;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++) cnt[i]+=cnt[i<span class="number">-1</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=n;i&gt;=<span class="number">1</span>;i--) sa[cnt[px[i]]--]=id[i];</span><br><span class="line">        <span class="built_in">memcpy</span>(LastRank,Rank,<span class="built_in">sizeof</span>(Rank));p=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++) Rank[sa[i]]=<span class="built_in">Cmp</span>(sa[i],sa[i<span class="number">-1</span>],w)?p:++p;</span><br><span class="line">        <span class="keyword">if</span>(p==n) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="后缀数组求-height"><a href="#后缀数组求-height" class="headerlink" title="后缀数组求 height"></a>后缀数组求 height</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">GetHeight</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>,k=<span class="number">0</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(k) k--;</span><br><span class="line">        <span class="keyword">while</span>(s[i+k]==s[sa[rk[i<span class="number">-1</span>]<span class="number">-1</span>]+k]) k++;</span><br><span class="line">        Height[rk[i]]=k;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="FFT-与-NTT（非转置原理实现）"><a href="#FFT-与-NTT（非转置原理实现）" class="headerlink" title="FFT 与 NTT（非转置原理实现）"></a>FFT 与 NTT（非转置原理实现）</h1><p>注意到换完之后的位置实际上是原来位置的二进制翻转。而二进制翻转我们可以 $O(n)$ 的去做这个东西。</p>
<p>注意到我们可以在转移上加以优化，这样就避免了所有数组的复制操作。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">Gettr</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++) tr[i]=(tr[i&gt;&gt;<span class="number">1</span>]&gt;&gt;<span class="number">1</span>)|((i&amp;<span class="number">1</span>)?(n&gt;&gt;<span class="number">1</span>):<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">fft</span><span class="params">(cp *f,<span class="type">bool</span> flag)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++) <span class="keyword">if</span>(i&lt;tr[i]) <span class="built_in">swap</span>(f[i],f[tr[i]]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> p=<span class="number">2</span>;p&lt;=n;p&lt;&lt;=<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="type">int</span> len=p&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        <span class="function">cp <span class="title">tg</span><span class="params">(cos(<span class="number">2</span>*pi/p),sin(<span class="number">2</span>*pi/p))</span></span>;</span><br><span class="line">        <span class="keyword">if</span>(!flag) tg.y*=<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>;k&lt;n;k+=p)&#123;</span><br><span class="line">            <span class="function">cp <span class="title">buf</span><span class="params">(<span class="number">1</span>,<span class="number">0</span>)</span></span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> l=k;l&lt;k+len;l++)&#123;</span><br><span class="line">                cp tt=buf*f[len+l];</span><br><span class="line">                f[len+l]=f[l]-tt;</span><br><span class="line">                f[l]=f[l]+tt;</span><br><span class="line">                buf=buf*tg;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">NTT</span><span class="params">(<span class="type">int</span> *f,<span class="type">int</span> len,<span class="type">int</span> flag)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;len;i++) <span class="keyword">if</span>(i&lt;tr[i]) <span class="built_in">swap</span>(f[i],f[tr[i]]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=len;i&lt;&lt;=<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="type">int</span> tg=<span class="built_in">ksm</span>(g,(mod<span class="number">-1</span>)/i,mod),l=i&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(flag==<span class="number">-1</span>) tg=<span class="built_in">ksm</span>(tg,mod<span class="number">-2</span>,mod);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;len;j+=i)&#123;</span><br><span class="line">            <span class="type">int</span> buf=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> k=j;k&lt;j+l;k++)&#123;</span><br><span class="line">                <span class="type">int</span> tt=<span class="number">1ll</span>*buf*f[k+l]%mod;</span><br><span class="line">                f[k+l]=((f[k]-tt)%mod+mod)%mod;</span><br><span class="line">                f[k]=(f[k]+tt)%mod;buf=<span class="number">1ll</span>*buf*tg%mod;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(flag==<span class="number">1</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="type">int</span> inv=<span class="built_in">ksm</span>(len,mod<span class="number">-2</span>,mod);<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;len;i++) f[i]=<span class="number">1ll</span>*f[i]*inv%mod;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="多项式求逆"><a href="#多项式求逆" class="headerlink" title="多项式求逆"></a>多项式求逆</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">GetInv</span><span class="params">(<span class="type">int</span> len,<span class="type">const</span> <span class="type">int</span> *a,<span class="type">int</span> *b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(len==<span class="number">1</span>)&#123;b[<span class="number">0</span>]=<span class="built_in">ksm</span>(a[<span class="number">0</span>],mod<span class="number">-2</span>,mod);<span class="keyword">return</span>;&#125;</span><br><span class="line">    <span class="built_in">GetInv</span>((len<span class="number">+1</span>)&gt;&gt;<span class="number">1</span>,a,b);<span class="type">int</span> m=<span class="number">1</span>;<span class="keyword">while</span>(m&lt;(len&lt;&lt;<span class="number">1</span>)) m&lt;&lt;=<span class="number">1</span>;<span class="built_in">Gettr</span>(m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;len;i++) c[i]=a[i];<span class="keyword">for</span>(<span class="type">int</span> i=len;i&lt;m;i++) c[i]=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">NTT</span>(c,m,<span class="number">1</span>);<span class="built_in">NTT</span>(b,m,<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;m;i++) b[i]=<span class="number">1ll</span>*(<span class="number">2</span><span class="number">-1ll</span>*c[i]*b[i]%mod+mod)%mod*b[i]%mod;</span><br><span class="line">    <span class="built_in">NTT</span>(b,m,<span class="number">-1</span>);<span class="keyword">for</span>(<span class="type">int</span> i=len;i&lt;m;i++) b[i]=<span class="number">0</span>;<span class="built_in">Clear</span>(c,m);</span><br><span class="line">&#125;<span class="comment">//c is not clear</span></span><br></pre></td></tr></table></figure>

<h1 id="多项式除法"><a href="#多项式除法" class="headerlink" title="多项式除法"></a>多项式除法</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">GetDivi</span><span class="params">(<span class="type">int</span> lena,<span class="type">int</span> lenb,<span class="type">const</span> <span class="type">int</span> *a,<span class="type">const</span> <span class="type">int</span> *b,<span class="type">int</span> *f,<span class="type">int</span> *h)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> len=lena-lenb<span class="number">+1</span>;<span class="type">int</span> m=<span class="number">1</span>;<span class="keyword">while</span>(m&lt;(len&lt;&lt;<span class="number">1</span>)) m&lt;&lt;=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;lena;i++) A[i]=a[i];<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;lenb;i++) B[i]=b[i];</span><br><span class="line">    <span class="built_in">reverse</span>(A,A+lena);<span class="built_in">reverse</span>(B,B+lenb);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=len;i&lt;lena;i++) A[i]=<span class="number">0</span>;<span class="keyword">for</span>(<span class="type">int</span> i=len;i&lt;lenb;i++) B[i]=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">GetInv</span>(len,B,d);<span class="built_in">Gettr</span>(m);<span class="built_in">NTT</span>(A,m,<span class="number">1</span>);<span class="built_in">NTT</span>(d,m,<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;m;i++) f[i]=<span class="number">1ll</span>*A[i]*d[i]%mod;<span class="built_in">NTT</span>(f,m,<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=len;i&lt;m;i++) f[i]=<span class="number">0</span>;<span class="built_in">reverse</span>(f,f+len);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;lena;i++) A[i]=a[i];<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;lenb;i++) B[i]=b[i];</span><br><span class="line">    m=<span class="number">1</span>;<span class="keyword">while</span>(m&lt;(lenb+lena)) m&lt;&lt;=<span class="number">1</span>;<span class="built_in">Gettr</span>(m);</span><br><span class="line">    <span class="built_in">NTT</span>(A,m,<span class="number">1</span>);<span class="built_in">NTT</span>(B,m,<span class="number">1</span>);<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;len;i++) c[i]=f[i];<span class="keyword">for</span>(<span class="type">int</span> i=len;i&lt;m;i++) c[i]=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">NTT</span>(c,m,<span class="number">1</span>);<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;m;i++) h[i]=((A[i]<span class="number">-1ll</span>*B[i]*c[i]%mod)%mod+mod)%mod;<span class="built_in">NTT</span>(h,m,<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=lenb;i&lt;m;i++) h[i]=<span class="number">0</span>;</span><br><span class="line">&#125;<span class="comment">//A,B,c,d is not clear</span></span><br></pre></td></tr></table></figure>

<h1 id="多项式开根"><a href="#多项式开根" class="headerlink" title="多项式开根"></a>多项式开根</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">GetSqrt</span><span class="params">(<span class="type">int</span> len,<span class="type">const</span> <span class="type">int</span> *a,<span class="type">int</span> *b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(len==<span class="number">1</span>)&#123;b[<span class="number">0</span>]=a[<span class="number">0</span>];<span class="keyword">return</span>;&#125;</span><br><span class="line">    <span class="built_in">GetSqrt</span>((len<span class="number">+1</span>)&gt;&gt;<span class="number">1</span>,a,b);<span class="type">int</span> m=<span class="number">1</span>;<span class="keyword">while</span>(m&lt;(len&lt;&lt;<span class="number">1</span>)) m&lt;&lt;=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;len;i++) b[i]&lt;&lt;=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;m;i++) d[i]=<span class="number">0</span>;<span class="built_in">GetInv</span>(len,b,d);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;len;i++) b[i]&gt;&gt;=<span class="number">1</span>;<span class="built_in">Gettr</span>(m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;len;i++) c[i]=a[i];<span class="keyword">for</span>(<span class="type">int</span> i=len;i&lt;m;i++) c[i]=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">NTT</span>(c,m,<span class="number">1</span>);<span class="built_in">NTT</span>(c,m,<span class="number">1</span>);<span class="built_in">NTT</span>(b,m,<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;m;i++) b[i]=<span class="number">1ll</span>*(<span class="number">1ll</span>*b[i]*b[i]%mod+c[i])%mod*d[i]%mod;</span><br><span class="line">    <span class="built_in">NTT</span>(b,m,<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=len;i&lt;m;i++) b[i]=<span class="number">0</span>;</span><br><span class="line">&#125;<span class="comment">//c,d is not clear</span></span><br></pre></td></tr></table></figure>

<h1 id="多项式-exp"><a href="#多项式-exp" class="headerlink" title="多项式 exp"></a>多项式 exp</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">GetExp</span><span class="params">(<span class="type">int</span> len,<span class="type">const</span> <span class="type">int</span> *a,<span class="type">int</span> *b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(len==<span class="number">1</span>)&#123;b[<span class="number">0</span>]=<span class="number">1</span>;<span class="keyword">return</span>;&#125;</span><br><span class="line">    <span class="built_in">GetExp</span>((len<span class="number">+1</span>)&gt;&gt;<span class="number">1</span>,a,b);<span class="built_in">GetLn</span>(len,b,C);</span><br><span class="line">    <span class="type">int</span> m=<span class="number">1</span>;<span class="keyword">while</span>(m&lt;(len&lt;&lt;<span class="number">1</span>)) m&lt;&lt;=<span class="number">1</span>;<span class="built_in">Gettr</span>(m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;len;i++) A[i]=a[i];<span class="keyword">for</span>(<span class="type">int</span> i=len;i&lt;m;i++) A[i]=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">NTT</span>(b,m,<span class="number">1</span>);<span class="built_in">NTT</span>(C,m,<span class="number">1</span>);<span class="built_in">NTT</span>(A,m,<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;m;i++) b[i]=(<span class="number">1ll</span>*b[i]*((A[i]-C[i])%mod)%mod+b[i])%mod;</span><br><span class="line">    <span class="built_in">NTT</span>(b,m,<span class="number">-1</span>);<span class="keyword">for</span>(<span class="type">int</span> i=len;i&lt;m;i++) b[i]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;m;i++) C[i]=<span class="number">0</span>;<span class="built_in">Clear</span>(A,m);<span class="built_in">Clear</span>(B,m);<span class="built_in">Clear</span>(c,m);<span class="built_in">Clear</span>(d,m);<span class="built_in">Clear</span>(C,m);</span><br><span class="line">&#125;<span class="comment">//A,B,c,d,C is not clear</span></span><br></pre></td></tr></table></figure>

<h1 id="多项式取-ln"><a href="#多项式取-ln" class="headerlink" title="多项式取 ln"></a>多项式取 ln</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">GetLn</span><span class="params">(<span class="type">int</span> len,<span class="type">const</span> <span class="type">int</span> *a,<span class="type">int</span> *b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;len;i++) A[i<span class="number">-1</span>]=<span class="number">1ll</span>*a[i]*i%mod;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;len;i++) B[i]=a[i];<span class="built_in">GetInv</span>(len,B,d);</span><br><span class="line">    <span class="type">int</span> m=<span class="number">1</span>;<span class="keyword">while</span>(m&lt;(len&lt;&lt;<span class="number">1</span>)) m&lt;&lt;=<span class="number">1</span>;<span class="built_in">NTT</span>(A,m,<span class="number">1</span>);<span class="built_in">NTT</span>(d,m,<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;m;i++) b[i]=<span class="number">1ll</span>*A[i]*d[i]%mod;<span class="built_in">NTT</span>(b,m,<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=len<span class="number">-1</span>;i&lt;m;i++) b[i]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=len<span class="number">-1</span>;i&gt;=<span class="number">1</span>;i--) b[i]=<span class="number">1ll</span>*b[i<span class="number">-1</span>]*<span class="built_in">ksm</span>(i,mod<span class="number">-2</span>,mod)%mod;</span><br><span class="line">    b[<span class="number">0</span>]=<span class="number">0</span>;<span class="built_in">Clear</span>(A,m);<span class="built_in">Clear</span>(B,m);<span class="built_in">Clear</span>(c,m);<span class="built_in">Clear</span>(d,m);</span><br><span class="line">&#125;<span class="comment">//A,B,c,d, is not clear</span></span><br></pre></td></tr></table></figure>

<h1 id="Tarjan-求-scc"><a href="#Tarjan-求-scc" class="headerlink" title="Tarjan 求 scc"></a>Tarjan 求 scc</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">Tarjan</span><span class="params">(<span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">    dfn[k]=low[k]=++tot;sta[++top]=k;ins[k]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> to:e[k])&#123;</span><br><span class="line">        <span class="keyword">if</span>(!dfn[to])&#123;<span class="built_in">Tarjan</span>(to);low[k]=<span class="built_in">min</span>(low[k],low[to]);&#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(ins[to]) low[k]=<span class="built_in">min</span>(dfn[to],low[k]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(dfn[k]==low[k])&#123;</span><br><span class="line">        <span class="type">int</span> z;ctot++;<span class="keyword">do</span>&#123;z=sta[top--];vdcc[ctot].<span class="built_in">pb</span>(z);c[z]=ctot;ins[z]=<span class="number">0</span>;&#125;<span class="keyword">while</span>(z!=k);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="线性基"><a href="#线性基" class="headerlink" title="线性基"></a>线性基</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">LinearBasis</span>&#123;</span><br><span class="line">    <span class="type">int</span> p[N];</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">Insert</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">        <span class="built_in">dec</span>(i,<span class="number">0</span>,<span class="number">49</span>) <span class="keyword">if</span>((x&gt;&gt;i)&amp;<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(!p[i])&#123;p[i]=x;<span class="keyword">return</span>;&#125;</span><br><span class="line">            <span class="keyword">else</span> x^=p[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Ask</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="type">int</span> ans=<span class="number">0</span>;</span><br><span class="line">        <span class="built_in">dec</span>(i,<span class="number">0</span>,<span class="number">49</span>) <span class="keyword">if</span>((ans^p[i])&gt;ans) ans^=p[i];</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;lb;</span><br></pre></td></tr></table></figure>

<h1 id="左偏树"><a href="#左偏树" class="headerlink" title="左偏树"></a>左偏树</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">LeftHeap</span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Merge</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!a||!b) <span class="keyword">return</span> a+b;<span class="keyword">if</span>(p[b].v&gt;p[a].v) <span class="built_in">swap</span>(a,b);</span><br><span class="line">        <span class="built_in">rs</span>(a)=<span class="built_in">Merge</span>(<span class="built_in">rs</span>(a),b);<span class="keyword">if</span>(p[<span class="built_in">rs</span>(a)].dist&gt;p[<span class="built_in">ls</span>(a)].dist) <span class="built_in">swap</span>(<span class="built_in">rs</span>(a),<span class="built_in">ls</span>(a));</span><br><span class="line">        p[a].dist=p[<span class="built_in">rs</span>(a)].dist<span class="number">+1</span>;<span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Pop</span><span class="params">(<span class="type">int</span> k)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">Merge</span>(<span class="built_in">ls</span>(k),<span class="built_in">rs</span>(k));&#125;</span><br><span class="line">&#125;st;</span><br></pre></td></tr></table></figure>

<h1 id="自然数幂和拉格朗日插值部分"><a href="#自然数幂和拉格朗日插值部分" class="headerlink" title="自然数幂和拉格朗日插值部分"></a>自然数幂和拉格朗日插值部分</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Leg</span><span class="params">(<span class="type">int</span> h)</span></span>&#123;</span><br><span class="line">    sum=<span class="number">1</span>;<span class="built_in">rep</span>(i,<span class="number">1</span>,k<span class="number">+2</span>) sum=<span class="number">1ll</span>*sum*(h-x[i])%mod;</span><br><span class="line">    <span class="built_in">rep</span>(i,<span class="number">1</span>,k<span class="number">+2</span>) x[i]=sum*<span class="built_in">inv</span>(h-x[i])%mod;</span><br><span class="line">    <span class="type">int</span> ans=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">rep</span>(i,<span class="number">1</span>,k<span class="number">+2</span>)&#123;</span><br><span class="line">        ans=(ans+y[i]*x[i]%mod*invjie[i<span class="number">-1</span>]%mod*invjie[k<span class="number">+2</span>-i]%mod*(((k<span class="number">+2</span>-i)&amp;<span class="number">1</span>)?(mod<span class="number">-1</span>):<span class="number">1</span>)%mod)%mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="李超树-1"><a href="#李超树-1" class="headerlink" title="李超树"></a>李超树</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span>&#123;</span><br><span class="line">    <span class="type">int</span> ls,rs,mx,mi;</span><br><span class="line">&#125;p[N];</span><br><span class="line"><span class="type">int</span> tot;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="title">LCT</span><span class="params">()</span></span>&#123;tot=<span class="number">0</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">ChangeMin</span><span class="params">(<span class="type">int</span> &amp;k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> z,<span class="type">int</span> y,<span class="type">int</span> id)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!k)&#123;k=++tot;<span class="built_in">assert</span>(tot&lt;=N<span class="number">-1</span>);&#125;</span><br><span class="line">    <span class="keyword">if</span>(l==r)&#123;<span class="keyword">if</span>(!p[k].mi||<span class="built_in">F</span>(p[k].mi,l)&gt;<span class="built_in">F</span>(id,l)) p[k].mi=id;<span class="keyword">return</span>;&#125;<span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(z&lt;=l&amp;&amp;r&lt;=y)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!p[k].mi) p[k].mi=id;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">F</span>(p[k].mi,mid)&gt;<span class="built_in">F</span>(id,mid)) <span class="built_in">swap</span>(p[k].mi,id);</span><br><span class="line">        (<span class="built_in">F</span>(id,l)&lt;<span class="built_in">F</span>(p[k].mi,l))?<span class="built_in">ChangeMin</span>(<span class="built_in">ls</span>(k),l,mid,z,y,id):<span class="built_in">ChangeMin</span>(<span class="built_in">rs</span>(k),mid<span class="number">+1</span>,r,z,y,id);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(z&lt;=mid) <span class="built_in">ChangeMin</span>(<span class="built_in">ls</span>(k),l,mid,z,y,id);<span class="keyword">if</span>(mid&lt;y) <span class="built_in">ChangeMin</span>(<span class="built_in">rs</span>(k),mid<span class="number">+1</span>,r,z,y,id);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">ChangeMax</span><span class="params">(<span class="type">int</span> &amp;k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> z,<span class="type">int</span> y,<span class="type">int</span> id)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!k)&#123;k=++tot;&#125;</span><br><span class="line">    <span class="keyword">if</span>(l==r)&#123;<span class="keyword">if</span>(!p[k].mx||<span class="built_in">F</span>(p[k].mx,l)&lt;<span class="built_in">F</span>(id,l)) p[k].mx=id;<span class="keyword">return</span>;&#125;<span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(z&lt;=l&amp;&amp;r&lt;=y)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!p[k].mx) p[k].mx=id;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">F</span>(p[k].mx,mid)&lt;<span class="built_in">F</span>(id,mid)) <span class="built_in">swap</span>(p[k].mx,id);</span><br><span class="line">        (<span class="built_in">F</span>(id,l)&gt;<span class="built_in">F</span>(p[k].mx,l))?<span class="built_in">ChangeMax</span>(<span class="built_in">ls</span>(k),l,mid,z,y,id):<span class="built_in">ChangeMax</span>(<span class="built_in">rs</span>(k),mid<span class="number">+1</span>,r,z,y,id);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(z&lt;=mid) <span class="built_in">ChangeMax</span>(<span class="built_in">ls</span>(k),l,mid,z,y,id);<span class="keyword">if</span>(mid&lt;y) <span class="built_in">ChangeMax</span>(<span class="built_in">rs</span>(k),mid<span class="number">+1</span>,r,z,y,id);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">Change</span><span class="params">(<span class="type">int</span> &amp;k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> z,<span class="type">int</span> y,<span class="type">int</span> id)</span></span>&#123;</span><br><span class="line">    <span class="built_in">ChangeMin</span>(k,l,r,z,y,id);<span class="built_in">ChangeMax</span>(k,l,r,z,y,id);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">AskMin</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> w)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!k) <span class="keyword">return</span> <span class="number">0</span>;<span class="keyword">if</span>(l==r) <span class="keyword">return</span> p[k].mi;</span><br><span class="line">    <span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;<span class="type">int</span> id=<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">if</span>(w&lt;=mid) id=<span class="built_in">AskMin</span>(<span class="built_in">ls</span>(k),l,mid,w);<span class="keyword">else</span> id=<span class="built_in">AskMin</span>(<span class="built_in">rs</span>(k),mid<span class="number">+1</span>,r,w);</span><br><span class="line">    <span class="keyword">if</span>(id==<span class="number">0</span>) <span class="keyword">return</span> p[k].mi;</span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">F</span>(id,w)&lt;<span class="built_in">F</span>(p[k].mi,w))?id:p[k].mi;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">AskMax</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> w)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!k) <span class="keyword">return</span> <span class="number">0</span>;<span class="keyword">if</span>(l==r) <span class="keyword">return</span> p[k].mx;</span><br><span class="line">    <span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;<span class="type">int</span> id=<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">if</span>(w&lt;=mid) id=<span class="built_in">AskMax</span>(<span class="built_in">ls</span>(k),l,mid,w);<span class="keyword">else</span> id=<span class="built_in">AskMax</span>(<span class="built_in">rs</span>(k),mid<span class="number">+1</span>,r,w);</span><br><span class="line">    <span class="keyword">if</span>(id==<span class="number">0</span>) <span class="keyword">return</span> p[k].mx;</span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">F</span>(id,w)&gt;<span class="built_in">F</span>(p[k].mx,w))?id:p[k].mx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">Clear</span><span class="params">()</span></span>&#123;<span class="built_in">mset</span>(p,<span class="number">0</span>);rt=<span class="number">0</span>;tot=<span class="number">0</span>;&#125;</span><br></pre></td></tr></table></figure>
        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>HYLTianMeng</span>
                    </p>
                
                
                
                    <p class="copyright-item">
                        <span>License:</span>
                        <span>Copyright (c) 2019 <a target="_blank" rel="noopener" href="http://creativecommons.org/licenses/by-nc/4.0/">CC-BY-NC-4.0</a> LICENSE</span>
                    </p>
                
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tags/%E4%BB%A3%E7%A0%81%E4%BB%93%E5%BA%93/"># 代码仓库</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2022/07/08/%E6%95%B0%E5%AD%A6%E6%9D%82%E8%B0%88/">数学杂谈</a>
            
            
            <a class="next" rel="next" href="/2022/06/19/%E4%BA%8C%E6%AC%A1%E5%89%A9%E4%BD%99/">二次剩余</a>
            
        </section>


    </article>
</div>

            </div>
            <footer id="footer" class="footer">
    <div class="copyright">
        <span>© HYLTianMeng | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
</body>

</html>